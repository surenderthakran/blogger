<!DOCTYPE html>
<html lang="en">
  <head>
<title>Introducing GoMind - A Simplistic Neural Network Library in Go | Surender Thakran</title>
<meta name="description" content="Introducing GoMind. A Neural Network Library in Go">
<meta name="author" content="Surender Thakran">
<meta charset="utf-8">
<meta name="keywords" content="go,golang,neural-network,back-propagation,deep-learning">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Added to have blog's theme color on browser's address bar in mobile browsers -->
<meta name="theme-color" content="#5B2358" />
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<meta property="og:title" content="Introducing GoMind - A Simplistic Neural Network Library in Go | Surender Thakran" />
<meta property="og:type" content="blog" />
<link rel="stylesheet" href="/css/main.min.css">
<script async src="/js/main.min.js"></script>
<!-- Prism for syntax highlighting -->
<link rel="stylesheet" href="/vendor/prism/prism.min.css">
<script async src="/vendor/prism/prism.min.js"></script>
<!-- Included to create a TCP connection with the google analytics server to speed up analytics.js download -->
<link rel="preconnect" href="//www.google-analytics.com">
<script>
  if (window.location.hostname === "surenderthakran.com" || window.location.hostname === "www.surenderthakran.com") {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-78619965-1', 'auto');
    ga('send', 'pageview');
  }
</script>
  </head>
  <body>
<header class="page-header">
  <div class="content">
    <div class="signature">
      <img id="header-image" class="owner-image"
           alt="Surender Thakran's Image"
           src="/images/owner.jpeg">
      <div>
        <a href="/">
          <p>SURENDER THAKRAN</p>
        </a>
        <p>Technology Enthusiast</p>
      </div>
    </div>
    <div class="centerbar">
      <a href="https://github.com/surenderthakran" target="_blank">
        <img class="github" alt="GitHub Logo"
             src="/images/github_logo_small.png">
      </a>
      <a href="https://in.linkedin.com/in/surenderthakran" target="_blank">
        <img class="linkedin" alt="LinkedIn Logo"
             src="/images/linkedin_logo_small.png">
      </a>
      <a href="https://store.docker.com/profiles/surenderthakran"
         target="_blank">
        <img class="docker" alt="Docker Logo"
             src="/images/docker_logo_small.png">
      </a>
    </div>
    <nav class="menu">
      <ul>
        <li>
          <a href="/">HOME</a>
        </li>
        <li>
          <a href="/projects">PROJECTS</a>
        </li>
        <li>
          <a href="/about">ABOUT</a>
        </li>
      </ul>
    </nav>
    <nav class="hamburger">
      <button title="menu icon"
              aria-label="menu icon"
              aria-pressed="false"
              id="hamburger"></button>
    </nav>
  </div>
  <div id="drawer" class="drawer hide">
    <ul>
      <li>
        <a href="https://github.com/surenderthakran" target="_blank">
          <img class="logo github" alt="GitHub Logo"
               src="/images/github_logo_small.png">
        </a>
        <a href="https://in.linkedin.com/in/surenderthakran" target="_blank">
          <img class="logo linkedin" alt="LinkedIn Logo"
               src="/images/linkedin_logo_small.png">
        </a>
        <a href="https://store.docker.com/profiles/surenderthakran"
           target="_blank">
          <img class="logo docker" alt="Docker Logo"
               src="/images/docker_logo_small.png">
        </a>
      </li>
      <li>
        <a class="menu-link" href="/">HOME</a>
      </li>
      <li>
        <a class="menu-link" href="/projects">PROJECTS</a>
      </li>
      <li>
        <a class="menu-link" href="/about">ABOUT</a>
      </li>
    </ul>
  </div>
</header>
<div class="spacer"></div>
    <section class="article">
      <header class="head">
        <h1>Introducing GoMind: A Simplistic Neural Network Library in Go</h1>
        <time datetime="2018-07-29">Published On: 29th July 2018</time>
        <p class="tags">
          <span>Neural Network</span>
          <span>Go</span>
        </p>
      </header>
      <article class="body">
        <h2>What is GoMind?</h2>
<p><a href="https://github.com/surenderthakran/gomind" target="_blank">GoMind</a>
  is a simplistic Neural Network library written entirely in
  <a href="https://golang.org/" target="_blank">Go (GoLang)</a>.
</p>
<p>GoMind is built upon learnings from my previous article where I had <a
  href="/articles/tech/implement-back-propagation-neural-network"
  target="_blank">explained Neural Networks and back propagation algorithms</a>
  in detail.
</p>
<p>Soon after its release, GoMind became a proud member of <a
  href="https://github.com/avelino/awesome-go" target="_blank">Avelino's curated
  list of awesome go projects.</a>
</p>
<h3>Why bother?</h3>
<p>I started learning Neural Network as an intellectual exercise and like
  almost every learning exercise it is best to set an end goal. In my case I
  decided on a two-dimensional self driving car simulation project, which I in
  my magnanimosity christened, <a href="https://github.com/surenderthakran/vaahan"
    target="_blank">Vaahan</a>.
</p>
<p>Over the course of the project I was forced to write my own computational
  geometry library, which I started calling <a href="https://github.com/surenderthakran/vaahan/tree/master/src/vaahan/gogeo"
    target="_blank">GoGeo</a>, for the of lack of any reliable library in Go like
  Python's <a href="http://www.sympy.org/en/index.html" target="_blank">
  SymPy</a>. Hopefully some day GoGeo will also get its own repositiory but it
  has a long journey ahead of it before that happens.
</p>
<p>Similarly after a while a need arose for a neural network library which
  gelled perfectly with Vaahan and was also simplistic enough for quick training
  exercises. But I would be lying if I said that I only wrote GoMind because of
  lack of good open source libraries in Go. No, the reason for starting
  GoMind is again educational. Afterall, what better way to understand neural
  networks than creating them yourselves?
</p>
<h3>Why Go?</h3>
<p>I do realise that I can bypass many of my challenges if I moved away from Go
  but recently Go has been my language of choice for most of my personal
  projects because of its gentle learning curve, educated opinionatedness,
  built-in testing framework alongwith its beautiful set of tools like <a
    href="https://golang.org/cmd/gofmt/" target="_blank">gofmt</a>, <a
    href="https://golang.org/cmd/fix/" target="_blank">fix</a> etc. There is no
  dearth of material on internet listing Go's many advantages.
</p>
<p><a
  href="/articles/tech/dockerized-development-and-production-environment-golang"
  target="_blank">Combining Go with docker</a> also creates a pretty smooth
  development pipeline.
</p>
<h2>Salient Features</h2>
<p>Even though still in its infancy, GoMind attempts to provide a few
  good-to-have features for a neural network library like:
</p>
<ul>
  <li>Smartly estimates ideal number of hidden layer neurons for given input and
    output sizes (if not configured during model creation).</li>
  <li>Uses educated default activation functions for hidden and output layers.
  </li>
  <li>Supports the following activation functions:
    <ul>
      <li>Linear</li>
      <li>
        <a href="https://en.wikipedia.org/wiki/Sigmoid_function"
           target="_blank">Sigmoid (Logistic)</a>
      </li>
      <li>
        <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)"
           target="_blank">ReLU (Rectified Linear Unit)</a>
      </li>
      <li>
        <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)#Leaky_ReLUs"
           target="_blank">Leaky ReLU</a>
      </li>
    </ul>
  </li>
  <li>Uses <a href="https://en.wikipedia.org/wiki/Mean_squared_error"
    target="_blank">Mean Squared Error</a> loss function for back propagation.
  </li>
</ul>
<h2>Code specs</h2>
<p>Every new push to the library is tested for Go versions 1.7 to 1.10 using
  <a href="https://travis-ci.com/surenderthakran/gomind" target="_blank">Travis
  CI</a>.</p>
<p>As of <a
  href="https://github.com/surenderthakran/gomind/releases/tag/v0.2-alpha"
  target="_blank">release v0.2-alpha</a> GoMind has over 83% test coverage (find
  latest coverage report <a href="https://codecov.io/gh/surenderthakran/gomind"
  target="_blank">here</a>).
</p>
<p>GoMind also scores an impressive A+ in code quality on <a
  href="https://goreportcard.com/" target="_blank">goreportcard.com</a>
  (checkout latest score <a
  href="https://goreportcard.com/report/github.com/surenderthakran/gomind"
  target="_blank">here</a>).
</p>
<h2>Usage</h2>
<h3>Installation</h3>
<p>GoMind can be installed using Go's go get command:</p>
<pre><code class="language-bash">go get github.com/surenderthakran/gomind</code></pre>
<h3>Example</h3>
<p>The following example teaches the XOR gate to GoMind's neural network.</p>
<pre><code class="language-go">package main

import (
	"github.com/singhsurender/gomind"
)

func main() {
	// XOR gate training set.
	trainingSet := [][][]float64{
		[][]float64{[]float64{0, 0}, []float64{0}},
		[][]float64{[]float64{0, 1}, []float64{1}},
		[][]float64{[]float64{1, 0}, []float64{1}},
		[][]float64{[]float64{1, 1}, []float64{0}},
	}

	// create neural network model.
	mind, err := gomind.New(&gomind.ModelConfiguration{
		NumberOfInputs:                    2,
		NumberOfOutputs:                   1,
		NumberOfHiddenLayerNeurons:        16,
		HiddenLayerActivationFunctionName: "relu",
		OutputLayerActivationFunctionName: "sigmoid",
	})
	if err != nil {
		return nil, fmt.Errorf("unable to create neural network. %v", err)
	}

	// iterate 500 times on random XOR gate transaction samples.
	for i := 0; i &lt; 500; i++ {
		rand := rand.Intn(4)
		input := trainingSet[rand][0]
		output := trainingSet[rand][1]

		// learn from random sample.
		if err := mind.LearnSample(input, output); err != nil {
			mind.Describe(true)
			return nil, fmt.Errorf("error while learning from sample input: %v, target: %v. %v", input, output, err)
		}

		// output guessed by the neural network.
		actual := mind.LastOutput()

		// error in network's guess.
		outputError, err := mind.CalculateError(output)
		if err != nil {
			mind.Describe(true)
			return nil, fmt.Errorf("error while calculating error for input: %v, target: %v and actual: %v. %v", input, output, actual, err)
		}

		// accuracy in network's guess.
		outputAccuracy, err := mind.CalculateAccuracy(output)
		if err != nil {
			mind.Describe(true)
			return nil, fmt.Errorf("error while calculating error for input: %v, target: %v and actual: %v. %v", input, output, actual, err)
		}

		fmt.Println("Index: %v, Input: %v, Target: %v, Actual: %v, Error: %v, Accuracy: %v\n", i, input, output, actual, outputError, outputAccuracy)
	}
}</code></pre>
<h2>Roadmap</h2>
<p>Following features are planned for future GoMind releases:</p>
<ul>
  <li>Perform training in Goroutines to improve concurrency.</li>
  <li>Ability to import and export network model.</li>
  <li>Ability to pause and resume training.</li>
  <li>Introduce more loss functions in addition to Mean Squared Error function.
  </li>
  <li>Provide in-built epoch running for learning.</li>
  <li>Provide in-built batch learning capability.</li>
</ul>
<h2>Confession</h2>
<p>While GoMind is nowhere close to machine learning giants like <a
  href="https://www.tensorflow.org/" target="_blank">Tensorflow</a> or <a
  href="http://scikit-learn.org/stable/" target="_blank">scikit-learn</a>, it
  serves it purpose as a simplistic library for quick training in Go without
  worrying about C bindings or pre-creating models in Python.
</p>

      </article>
    </section>
<footer>&copy; 2016-2018 Surender Thakran, unless stated otherwise.</footer>
  </body>
</html>
